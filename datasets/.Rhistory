set.seed(5)
x <- rnorm(200)
y <- x + rnorm(200)
plot.new()
plot.window(xlim = c(-4.5, 4.5), xaxs = "i",
ylim = c(-4.5, 4.5), yaxs = "i")
z <- lm(y ~ x)
abline(h = -4:4, v = -4:4, col = "lightgrey")
abline(a = coef(z)[1], b = coef(z)[2], lwd = 2, col = "red")
points(x, y)
axis(1)
axis(2, las = 1)
box()
title(main = "A Fitted Regression Line")
n <- 15
theta <- seq(0, 2 * pi, length = n + 1)[1:n]
x <- sin(theta)
y <- cos(theta)
v1 <- rep(1:n, n)
v2 <- rep(1:n, rep(n, n))
plot.new()
plot.window(xlim = c(-1, 1), ylim = c(-1, 1), asp = 1)
segments(x[v1], y[v1], x[v2], y[v2])
plot.new()
plot.window(xlim = c(0, 1), ylim = c(0, 1))
arrows(.05, .075, .45, .9, code = 1)
arrows(.55, .9, .95, .075, code = 2)
arrows(.1, 0, .9, 0, code = 3)
text(.5, 1, "A", cex = 1.5)
text(0, 0, "B", cex = 1.5)
text(1, 0, "C", cex = 1.5)
plot.new()
plot.window(xlim = c(0, 5), ylim = c(0, 10))
rect(0:4, 0, 1:5, c(7, 8, 4, 3),
col = "turquoise",
border = "white")
axis(1)
axis(2, las = 1)
x <- c(0.32, 0.62, 0.88, 0.89, 0.59, 0.29)
y <- c(0.83, 0.61, 0.66, 0.18, 0.36, 0.14)
plot.new()
plot.window(xlim = range(x), ylim = range(y))
polygon(x, y, col = "lightyellow")
box()
plot.new()
plot.window(xlim = range(x), ylim = range(y))
polygon(x, y, col = "orange")
box()
x <- c(0.32, 0.62, 0.88, 0.89, 0.59, 0.29)
y <- c(0.83, 0.61, 0.66, 0.18, 0.36, 0.14)
plot.new()
plot.window(xlim = range(x), ylim = range(y))
polygon(x, y, col = "orange", border = "gary50",
lwd = 3)
box()
plot.new()
plot.window(xlim = range(x), ylim = range(y))
polygon(x, y, col = "orange", border = "gray50",
lwd = 3)
box()
y <- c(0.32, 0.62, 0.88, 0.89, 0.59, 0.29)
x <- c(0.83, 0.61, 0.66, 0.18, 0.36, 0.14)
plot.new()
plot.window(xlim = range(x), ylim = range(y))
polygon(x, y, col = "orange", border = "gray30",
lwd = 3)
box()
plot.new()
plot.window(xlim = c(0, 1), ylim = c(0, 1))
abline(h = c(.2, .5, .8),
v = c(.5, .2, .8), col = "lightgrey")
text(0.5, 0.5, "srt = 45, adj = c(.5, .5)",
srt=45, adj=c(.5, .5))
text(0.5, 0.8, "adj = c(0, .5)", adj = c(0, .5))
text(0.5, 0.2, "adj = c(1, .5)", adj = c(1, .5))
text(0.2, 0.5, "adj = c(1, 1)", adj = c(1, 1))
text(0.8, 0.5, "adj = c(0, 0)", adj = c(0, 0))
axis(1); axis(2, las = 1); box()
xe <- seq(-3, 3, length = 1001)
ye <- dnorm(xe)
xa <- seq(-3, 3, length = 201)
ya <- dnorm(xa) + rnorm(201, sd = .01)
plot.new()
plot.window(xlim = c(-3, 3), ylim = range(ye, ya))
lines(xe, ye, lty = "11", lwd = 2)
lines(xa, ya, lty = "solid", lwd = 1)
legend(3, max(ylim), legend = c("Exact", "Approximate"),
lty = c("11", "solid"), lwd = c(2, 1),
xjust = 1, yjust = 1, bty = "n")
axis(1)
axis(2, las = 1)
box()
ylim <- range(ye, ya)
plot.new()
plot.window(xlim = c(-3, 3), ylim = ylim)
lines(xe, ye, lty = "11", lwd = 2)
lines(xa, ya, lty = "solid", lwd = 1)
legend(3, max(ylim), legend = c("Exact", "Approximate"),
lty = c("11", "solid"), lwd = c(2, 1),
xjust = 1, yjust = 1, bty = "n")
axis(1)
axis(2, las = 1)
box()
plot.new()
plot.window(xlim = c(-3, 3), ylim = ylim)
lines(xe, ye, lty = "11", lwd = 2)
lines(xa, ya, lty = "solid", lwd = 1)
legend(3, max(ylim), legend = c("Exact", "Approximate"),
lty = c("11", "solid"), lwd = c(2, 1),
xjust = 1, yjust = 1, bty = "n")
box()
library(XML)
?readHTMLTable
soc <- "http://www.soccerstats.com/widetable.asp?league=spain"
doc <- readHTMLTable(soc)
length(doc)
class(doc)
names(doc)
doc[1]
doc[2]
doc[[2]]
doc[[3]]
doc[[4]]
doc[[10]]
doc[[9]]
doc[11]
doc
sapply(doc, function(x) !is,null(x))
sapply(doc, function(x) !is.null(x))
doc[[49]]
doc[[48]]
doc[[40]]
doc[[41]]
doc[[42]]
doc[[43]]
doc[[44]]
doc[[45]]
doc[[46]]
doc[[50]]
doc[[49]]
soc <- "http://www.statto.com/football/stats/spain/primera-division/2014-2015/table"
doc <- readHTMLTable(soc)
doc <- readHTMLTable(soc)
rm(list = ls())
library(XML)
?readHTMLTable
soc <- "http://www.statto.com/football/stats/spain/primera-division/2014-2015/table"
doc <- readHTMLTable(soc)
length(doc)
class(doc)
sapply(doc, function(x) !is.null(x))
doc[[49]]
rm(list = ls())
getwd()
stats <- read.csv("liga2015.csv")
setwd("/Users/Gaston/Desktop/stat133/datasets")
stats <- read.csv("liga2015.csv")
str(stats, vec.len = 1)
stats <- read.csv("liga2015.csv", stringsAsFactors = FALSE)
str(stats, vec.len = 1)
stats <- read.csv("liga2015.csv", stringsAsFactors = FALSE)
str(stats, vec.len = 1)
stats$goals_for - stats$goals_against
stats$wins * 3 + stats$draws * 1
library(ggplot2)
ggplot(data = stats, aes(x = goals_favor, y = goals_against)) +
geom_point()
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point()
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point() +
geom_text(aes(label = team))
goal_diff <- stats$goals_for - stats$goals_against
points <- stats$wins * 3 + stats$draws * 1
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point(aes(size = points)) +
geom_text(aes(label = team))
head(stats, n = 4)
tail(stats, n = 4)
dim(stats)
colnames(stats)
str(stats, vec.len = 1)
ggplot(data = stats, aes(x = wins_for, y = wins_against)) +
geom_point()
ggplot(data = stats, aes(x = home_wins, y = away_wins)) +
geom_point()
?geom_line
ggplot(data = stats, aes(x = home_wins, y = away_wins)) +
geom_point() +
geom_abline(intercept = 0, slope = 1)
ggplot(data = stats, aes(x = home_wins, y = away_wins)) +
geom_point() +
geom_abline(intercept = 0, slope = 1, col = "gray70")
ggplot(data = stats, aes(x = home_wins, y = away_wins)) +
geom_point() +
geom_text(aes(label = team)) +
geom_abline(intercept = 0, slope = 1, col = "gray50")
?geom_text
ggplot(data = stats, aes(x = home_wins, y = away_wins)) +
geom_point() +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = 0, slope = 1, col = "gray50")
ggplot(data = stats, aes(x = home_wins, y = away_wins)) +
xlim(0, 18) + ylim(0, 18) +
geom_point() +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = 0, slope = 1, col = "gray50")
stats$goals_for / stats$played
goals_diff <- stats$goals_for - stats$goals_against
barplot(stats$goals_diff)
stats$goals_diff
goals_diff <- stats$goals_for - stats$goals_against
barplot(stats$goals_diff)
goals_diff
barplot(goals_diff)
barplot(goals_diff, names.arg = stats$team)
barplot(goals_diff, names.arg = stats$team, las = 2)
rm(list = ls())
stats <- read.csv("soccer-stats-2015.csv",
stringsAsFactors = FALSE)
# inspecting data
head(stats, n = 4)
tail(stats, n = 4)
dim(stats)
colnames(stats)
# full description
str(stats, vec.len = 1)
# goals difference
stats$goals_diff <- stats$goals_for - stats$goals_against
# total points
stats$points <- stats$wins * 3 + stats$draws * 1
# goals per game
stats$goals_game <- stats$goals_for / stats$played
barplot(stats$goals_diff, names.arg = stats$team, las = 2)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point()
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point(aes(size = points), hjust=0, vjust=0) +
geom_text(aes(label = team))
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(0, 125) + ylim(0, 70) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(25, 125) + ylim(0, 70) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(25, 125) + ylim(0, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(25, 125) + ylim(0, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=1, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(25, 125) + ylim(0, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point(aes(size = points)) +
geom_text(aes(label = team))
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(0, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
tolower(stats$team)
stats$team <- tolower(stats$team)
# adding size
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(0, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team, size = points), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points)) +
geom_text(aes(label = team, color = points), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points, color = points)) +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
write.csv(stats, file = "soccer-stats-2015.csv",
row.names = FALSE)
read.csv("soccer-stats-2015.csv",
stringsAsFactors = FALSE)
library(stringr)
?str)gsub
?str_gsub
?str_extract
op <- par(mar = c(8, 4, 2, 2))
barplot(stats$goals_diff, names.arg = stats$team, las = 2)
par(op)
op <- par(mar = c(9, 4, 2, 2))
barplot(stats$goals_diff, names.arg = stats$team, las = 2)
par(op)
op <- par(mar = c(9, 4, 2, 2))
barplot(stats$goals_diff, names.arg = stats$team, las = 2,
ylim = c(-45, 85))
par(op)
op <- par(mar = c(9, 4, 2, 2))
barplot(stats$goals_diff, names.arg = stats$team, las = 2,
ylim = c(-30, 90))
par(op)
op <- par(mar = c(9, 4, 2, 2))
barplot(stats$goals_diff, names.arg = stats$team, las = 2,
ylim = c(-50, 90))
par(op)
op <- par(mar = c(9, 4, 2, 2))
barplot(stats$goals_diff, names.arg = stats$team, las = 2)
par(op)
stats$goals_per_game
stats$goals_game
plot(stats$goals_game, stats$goals_diff)
abline(h = 0, v = 0)
plot(stats$goals_game, stats$goals_diff,
xlim = c(0, 3.5))
abline(h = 0, v = 0)
stats
lm(stats$points ~ stats$goals_for + stats$goals_away)
stats$points
lm(stats$points ~ stats$goals_for + stats$goals_away)
stats$goals_for
stats$goals_away
lm(stats$points ~ stats$goals_for + stats$goals_against)
lm1 <- lm(stats$points ~ stats$goals_for + stats$goals_against)
summary(lm1)
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
stats$points
stats$goals_for / stats$wins
stats$goals_for / stats$losses
stats$goals_against / stats$losses
stats$goals_for / stats$wins
lm1 <- lm(stats$points ~ stats$goals_for)
summary(lm1)
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(15, 125) + ylim(15, 75) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = points)) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 140)
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 140) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 120) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0)
lm[1]
lm1[1]
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficiens[1],
slope = lm1$coefficients[2])
lm1$coefficiens[1]
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(aes(size = points), color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficients[1],
slope = lm1$coefficients[2])
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficients[1],
slope = lm1$coefficients[2])
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficients[1],
slope = lm1$coefficients[2],
col = "blue")
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficients[1],
slope = lm1$coefficients[2],
col = "gray40", size = 3)
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficients[1],
slope = lm1$coefficients[2],
col = "#888888aa", size = 3)
# adding size
ggplot(data = stats, aes(x = goals_for, y = points)) +
xlim(20, 130) +
geom_point(color = "tomato") +
geom_text(aes(label = team), hjust=0, vjust=0) +
geom_abline(intercept = lm1$coefficients[1],
slope = lm1$coefficients[2],
col = "#888888aa", size = 2)
lm1 <- lm(stats$points ~ stats$goals_for)
summary(lm1)
lm_pts <- lm(stats$points ~ stats$goals_for)
lm_pts
library(RCurl)
stats
barplot(stats$goals_diff)
boxplot(stats$wins)
hist(stats$wins)
hist(stats$wins)
hist(stats$draws)
hist(stats$losses)
# goals difference
barplot(stats$goals_diff, names.arg = stats$team, las = 2)
summary(stats)
summary(stats[ ,c('wins', 'draws', 'losses')])
stars(stats[,1:4])
names(stats)
stars(stats[,2:6])
stars(stats[,2:9])
stars(stats[,2:9], labels = stats$team)
stars(stats[,2:9], labels = stats$team, key.loc = c(5,5))
stars(stats[,2:9], labels = stats$team, key.loc = c(25,5))
stars(stats[,2:9], labels = stats$team, key.loc = c(15,5))
stars(stats[,2:9], labels = stats$team, key.loc = c(10,5))
?stars
stars(stats[ ,3:9], nrow = 4)
stars(stats[ ,3:9], nrow = 4, labels = stats$team)
stars(stats[ ,3:9], nrow = 4, labels = stats$team,
key.loc = c(5, 1))
stars(stats[ ,3:9], nrow = 4, labels = stats$team,
key.loc = c(5, 15))
stars(stats[ ,3:9], nrow = 4, labels = stats$team,
key.loc = c(5, 5))
stars(stats[ ,3:9], nrow = 4, labels = stats$team,
key.loc = c(5, 10))
stars(stats[ ,3:9], nrow = 4, labels = stats$team,
key.loc = c(5, 10))
ggplot(data = stats, aes(x = goals_for, y = goals_against)) +
geom_point()
rm(list = ls())
stats <- read.csv("soccer-data-2015.csv",
stringsAsFactors = FALSE)
stats
stats
paste(stats$goals, "goals", sep='')
paste(stats$goals, "goals", sep='')
paste(stats$goals_for, "goals", sep='')
paste(stats$goals_for, "goals")
stats$goals_for <- paste(stats$goals_for, "goals")
stats$goals_against <- paste(stats$goals_against, "goals")
stats <- write.csv("soccer-data-2015.csv",
row.names = FALSE)
stats <- read.csv("soccer-data-2015.csv",
stringsAsFactors = FALSE)
stats
stats <- read.csv("soccer-data-2015.csv",
stringsAsFactors = FALSE)
stats$goals_for <- paste(stats$goals_for, "goals")
stats$goals_against <- paste(stats$goals_against, "goals")
stats <- write.csv(stats, "soccer-data-2015.csv",
row.names = FALSE)
stats <- read.csv("soccer-data-2015.csv",
stringsAsFactors = FALSE)
stats
stats$goals_for
gsub(pattern = " goals",
replacement = "",
x = stats$goals_for)
gsub(
pattern = " goals",
replacement = "",
x = stats$goals_against)
library(stringr)
str_extract_all(string = stats$goals_against,
pattern = "\\d")
str_extract_all(string = stats$goals_against,
pattern = "\\d+")
str_extract_all(string = stats$goals_against,
pattern = "^[0-9]+")
str_extract(string = stats$goals_against,
pattern = "^[0-9]+")
goals_for
sub(
pattern = " goals",
replacement = "",
x = stats$goals_for)
